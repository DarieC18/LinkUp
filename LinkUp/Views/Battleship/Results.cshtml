@model LinkUp.Application.ViewModels.Battleship.ResultVm
@{
    ViewData["Title"] = "Resultados de la partida";
    var size = Model.BoardSize <= 0 ? 12 : Model.BoardSize;
}

<link rel="stylesheet" href="~/css/battleship.css" />

<div class="container py-3">

    <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
        <h2 class="mb-0">Resultados de la partida</h2>
    </div>

    <!-- Meta -->
    <div class="row g-3 mb-3">
        <div class="col-12 col-md-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">Ganador</div>
                    <div class="fw-semibold fs-5">@Model.WinnerDisplay</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">Inicio</div>
                    <div class="fw-semibold">@Model.StartedAt</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small">Finalización</div>
                    <div class="fw-semibold">@Model.FinishedAt</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-3">
        <div class="card-body">
            <h5 class="card-title mb-3">Mi tablero de ataques</h5>

            <div id="board" style="--cells:@size;">
                @for (var r = 0; r < size; r++)
                {
                    for (var c = 0; c < size; c++)
                    {
                        var state = Model.MyAttackState[r, c];
                        var cls = "cell";
                        if (state == 1) cls += " hit";
                        else if (state == 0) cls += " miss";

                        <button type="button"
                                class="@cls"
                                disabled
                                aria-label="fila @r, col @c">
                        </button>
                    }
                }
            </div>

            <!-- Leyenda -->
            <div class="mt-3 small text-muted d-flex flex-wrap gap-3">
                <span><span class="legend-box me-1" style="display:inline-block;width:14px;height:14px;border:1px solid #e5e7eb;background:#f87171;"></span> Acierto</span>
                <span><span class="legend-box me-1" style="display:inline-block;width:14px;height:14px;border:1px solid #e5e7eb;background:#93c5fd;"></span> Agua</span>
                <span><span class="legend-box me-1" style="display:inline-block;width:14px;height:14px;border:1px solid #e5e7eb;background:#f8fafc;"></span> Sin disparos</span>
            </div>
        </div>
    </div>

    <!-- Acciones -->
    <div class="d-flex flex-wrap gap-2">
        <a asp-action="Board" asp-route-gameId="@Model.GameId" class="btn btn-outline-primary">
            Ver mi tablero (posicionamiento)
        </a>
        <a asp-action="OpponentBoard" asp-route-gameId="@Model.GameId" class="btn btn-outline-dark">
            Ver tablero del otro jugador
        </a>
        <a asp-action="Index" class="btn btn-secondary">
            Volver al listado
        </a>
    </div>
</div>

@section Scripts {
    <style>
        #board .cell[disabled] {
            cursor: default;
        }
    </style>
}
